/* 2. 매출정보에 대한 시계열 그래프 - 하단표 SQL                  */
/*    오늘(2023.03.04)일 경우 => 기준일 : 2023.03.03              */
/*                               올해   : 2023.01.01 ~ 2023.12.31 */
/*                               전년도 : 2022.01.01 ~ 2022.12.31 */
WITH WT_WHERE AS
    (
        SELECT FRST_DT_YEAR             AS FR_DT      /* 기준일의  1월  1일       */
              ,BASE_YEAR    ||'-12-31'  AS TO_DT      /* 기준일의 12월 31일       */
              ,FRST_DT_YEAR_YOY         AS FR_DT_YOY  /* 기준년의  1월  1일  -1년 */
              ,BASE_YEAR_YOY||'-12-31'  AS TO_DT_YOY  /* 기준일의 12월 31일  -1년 */
              ,BASE_YEAR                AS THIS_YEAR  /* 기준일의 연도            */
              ,BASE_YEAR_YOY            AS LAST_YEAR  /* 기준일의 연도       -1년 */
              ,FRST_DT_MNTH_YOY         AS FR_DT_MNTH_YOY /* 기준일의 해당월 1일 -1년 */
              ,BASE_DT_YOY              AS TO_DT_MNTH_YOY /* 기준일              -1년 */
          FROM DASH.DASH_INITIAL_DATE
    ), WT_COPY AS
    (
        SELECT 1                                              AS SORT_KEY
              ,'올해 매출'                                    AS ROW_TITL
     UNION ALL
        SELECT 2                                              AS SORT_KEY
              ,'전년도 매출 '                                 AS ROW_TITL
     UNION ALL
        SELECT 3                                              AS SORT_KEY
              ,'YoY (전년도 동월 대비 매출 증감) '            AS ROW_TITL
     UNION ALL
        SELECT 4                                              AS SORT_KEY
              ,'MoM (당해 연도 전월 대비 매출 증감)'          AS ROW_TITL
    ), WT_EXCH AS
    (
        SELECT STATISTICS_DATE
              , PAYMENT_AMOUNT                                                                                    AS SALE_AMT_RMB   /* 일매출           - 위안화 */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0))                                           AS EXRE_AMT_RMB   /* 일매출(환불제외) - 위안화 */
              , PAYMENT_AMOUNT                                          * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS SALE_AMT_KRW   /* 일매출           - 원화   */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0)) * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS EXRE_AMT_KRW   /* 일매출(환불제외) - 원화   */
          FROM DASH_RAW.OVER_{TAG}_OVERALL_STORE A
         WHERE STATISTICS_DATE BETWEEN (SELECT FR_DT FROM WT_WHERE) AND (SELECT TO_DT FROM WT_WHERE)
    ), WT_EXCH_YOY AS
    (
        SELECT STATISTICS_DATE
              , PAYMENT_AMOUNT                                                                                    AS SALE_AMT_RMB   /* 일매출           YoY - 위안화 */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0))                                           AS EXRE_AMT_RMB   /* 일매출(환불제외) YoY - 위안화 */
              , PAYMENT_AMOUNT                                          * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS SALE_AMT_KRW   /* 일매출           YoY - 원화   */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0)) * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS EXRE_AMT_KRW   /* 일매출(환불제외) YoY - 원화   */
          FROM DASH_RAW.OVER_{TAG}_OVERALL_STORE A
         WHERE STATISTICS_DATE BETWEEN (SELECT FR_DT_YOY FROM WT_WHERE) AND (SELECT TO_DT_YOY FROM WT_WHERE)
    ), WT_EXCH_MNTH_YOY AS
    (
        SELECT STATISTICS_DATE
              , PAYMENT_AMOUNT                                                                                    AS SALE_AMT_RMB   /* 일매출           YoY - 위안화 */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0))                                           AS EXRE_AMT_RMB   /* 일매출(환불제외) YoY - 위안화 */
              , PAYMENT_AMOUNT                                          * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS SALE_AMT_KRW   /* 일매출           YoY - 원화   */
              ,(PAYMENT_AMOUNT - COALESCE(SUCCESSFUL_REFUND_AMOUNT, 0)) * DASH_RAW.SF_EXCH_KRW(A.STATISTICS_DATE) AS EXRE_AMT_KRW   /* 일매출(환불제외) YoY - 원화   */
          FROM DASH_RAW.OVER_{TAG}_OVERALL_STORE A
         WHERE STATISTICS_DATE BETWEEN (SELECT FR_DT_MNTH_YOY FROM WT_WHERE) AND (SELECT TO_DT_MNTH_YOY FROM WT_WHERE)
    ), WT_SUM_MNTH_YOY AS
    (
        SELECT EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) AS MNTH_YOY 
              ,SUM(SALE_AMT_RMB) AS SALE_AMT_RMB /* 매출           - 위안화 */
              ,SUM(EXRE_AMT_RMB) AS EXRE_AMT_RMB /* 매출(환불제외) - 위안화 */
              ,SUM(SALE_AMT_KRW) AS SALE_AMT_KRW /* 매출           -   원화 */
              ,SUM(EXRE_AMT_KRW) AS EXRE_AMT_KRW /* 매출(환불제외) -   원화 */
          FROM WT_EXCH_MNTH_YOY A
      GROUP BY MNTH_YOY 
    ), WT_SUM AS
    (
        SELECT 1  AS SORT_KEY
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN SALE_AMT_RMB END) AS SALE_AMT_01_RMB /* 01월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN SALE_AMT_RMB END) AS SALE_AMT_02_RMB /* 02월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN SALE_AMT_RMB END) AS SALE_AMT_03_RMB /* 03월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN SALE_AMT_RMB END) AS SALE_AMT_04_RMB /* 04월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN SALE_AMT_RMB END) AS SALE_AMT_05_RMB /* 05월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN SALE_AMT_RMB END) AS SALE_AMT_06_RMB /* 06월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN SALE_AMT_RMB END) AS SALE_AMT_07_RMB /* 07월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN SALE_AMT_RMB END) AS SALE_AMT_08_RMB /* 08월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN SALE_AMT_RMB END) AS SALE_AMT_09_RMB /* 09월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN SALE_AMT_RMB END) AS SALE_AMT_10_RMB /* 10월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN SALE_AMT_RMB END) AS SALE_AMT_11_RMB /* 11월 일매출           - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN SALE_AMT_RMB END) AS SALE_AMT_12_RMB /* 12월 일매출           - 위안화 */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN EXRE_AMT_RMB END) AS EXRE_AMT_01_RMB /* 01월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN EXRE_AMT_RMB END) AS EXRE_AMT_02_RMB /* 02월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN EXRE_AMT_RMB END) AS EXRE_AMT_03_RMB /* 03월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN EXRE_AMT_RMB END) AS EXRE_AMT_04_RMB /* 04월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN EXRE_AMT_RMB END) AS EXRE_AMT_05_RMB /* 05월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN EXRE_AMT_RMB END) AS EXRE_AMT_06_RMB /* 06월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN EXRE_AMT_RMB END) AS EXRE_AMT_07_RMB /* 07월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN EXRE_AMT_RMB END) AS EXRE_AMT_08_RMB /* 08월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN EXRE_AMT_RMB END) AS EXRE_AMT_09_RMB /* 09월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN EXRE_AMT_RMB END) AS EXRE_AMT_10_RMB /* 10월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN EXRE_AMT_RMB END) AS EXRE_AMT_11_RMB /* 11월 일매출(환불제외) - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN EXRE_AMT_RMB END) AS EXRE_AMT_12_RMB /* 12월 일매출(환불제외) - 위안화 */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN SALE_AMT_KRW END) AS SALE_AMT_01_KRW /* 01월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN SALE_AMT_KRW END) AS SALE_AMT_02_KRW /* 02월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN SALE_AMT_KRW END) AS SALE_AMT_03_KRW /* 03월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN SALE_AMT_KRW END) AS SALE_AMT_04_KRW /* 04월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN SALE_AMT_KRW END) AS SALE_AMT_05_KRW /* 05월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN SALE_AMT_KRW END) AS SALE_AMT_06_KRW /* 06월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN SALE_AMT_KRW END) AS SALE_AMT_07_KRW /* 07월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN SALE_AMT_KRW END) AS SALE_AMT_08_KRW /* 08월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN SALE_AMT_KRW END) AS SALE_AMT_09_KRW /* 09월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN SALE_AMT_KRW END) AS SALE_AMT_10_KRW /* 10월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN SALE_AMT_KRW END) AS SALE_AMT_11_KRW /* 11월 일매출           - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN SALE_AMT_KRW END) AS SALE_AMT_12_KRW /* 12월 일매출           - 원화   */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN EXRE_AMT_KRW END) AS EXRE_AMT_01_KRW /* 01월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN EXRE_AMT_KRW END) AS EXRE_AMT_02_KRW /* 02월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN EXRE_AMT_KRW END) AS EXRE_AMT_03_KRW /* 03월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN EXRE_AMT_KRW END) AS EXRE_AMT_04_KRW /* 04월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN EXRE_AMT_KRW END) AS EXRE_AMT_05_KRW /* 05월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN EXRE_AMT_KRW END) AS EXRE_AMT_06_KRW /* 06월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN EXRE_AMT_KRW END) AS EXRE_AMT_07_KRW /* 07월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN EXRE_AMT_KRW END) AS EXRE_AMT_08_KRW /* 08월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN EXRE_AMT_KRW END) AS EXRE_AMT_09_KRW /* 09월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN EXRE_AMT_KRW END) AS EXRE_AMT_10_KRW /* 10월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN EXRE_AMT_KRW END) AS EXRE_AMT_11_KRW /* 11월 일매출(환불제외) - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN EXRE_AMT_KRW END) AS EXRE_AMT_12_KRW /* 12월 일매출(환불제외) - 원화   */
          FROM WT_EXCH A
     UNION ALL
        SELECT 2  AS SORT_KEY
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN SALE_AMT_RMB END) AS SALE_AMT_01_RMB /* 01월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN SALE_AMT_RMB END) AS SALE_AMT_02_RMB /* 02월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN SALE_AMT_RMB END) AS SALE_AMT_03_RMB /* 03월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN SALE_AMT_RMB END) AS SALE_AMT_04_RMB /* 04월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN SALE_AMT_RMB END) AS SALE_AMT_05_RMB /* 05월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN SALE_AMT_RMB END) AS SALE_AMT_06_RMB /* 06월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN SALE_AMT_RMB END) AS SALE_AMT_07_RMB /* 07월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN SALE_AMT_RMB END) AS SALE_AMT_08_RMB /* 08월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN SALE_AMT_RMB END) AS SALE_AMT_09_RMB /* 09월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN SALE_AMT_RMB END) AS SALE_AMT_10_RMB /* 10월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN SALE_AMT_RMB END) AS SALE_AMT_11_RMB /* 11월 일매출           YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN SALE_AMT_RMB END) AS SALE_AMT_12_RMB /* 12월 일매출           YoY - 위안화 */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN EXRE_AMT_RMB END) AS EXRE_AMT_01_RMB /* 01월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN EXRE_AMT_RMB END) AS EXRE_AMT_02_RMB /* 02월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN EXRE_AMT_RMB END) AS EXRE_AMT_03_RMB /* 03월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN EXRE_AMT_RMB END) AS EXRE_AMT_04_RMB /* 04월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN EXRE_AMT_RMB END) AS EXRE_AMT_05_RMB /* 05월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN EXRE_AMT_RMB END) AS EXRE_AMT_06_RMB /* 06월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN EXRE_AMT_RMB END) AS EXRE_AMT_07_RMB /* 07월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN EXRE_AMT_RMB END) AS EXRE_AMT_08_RMB /* 08월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN EXRE_AMT_RMB END) AS EXRE_AMT_09_RMB /* 09월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN EXRE_AMT_RMB END) AS EXRE_AMT_10_RMB /* 10월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN EXRE_AMT_RMB END) AS EXRE_AMT_11_RMB /* 11월 일매출(환불제외) YoY - 위안화 */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN EXRE_AMT_RMB END) AS EXRE_AMT_12_RMB /* 12월 일매출(환불제외) YoY - 위안화 */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN SALE_AMT_KRW END) AS SALE_AMT_01_KRW /* 01월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN SALE_AMT_KRW END) AS SALE_AMT_02_KRW /* 02월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN SALE_AMT_KRW END) AS SALE_AMT_03_KRW /* 03월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN SALE_AMT_KRW END) AS SALE_AMT_04_KRW /* 04월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN SALE_AMT_KRW END) AS SALE_AMT_05_KRW /* 05월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN SALE_AMT_KRW END) AS SALE_AMT_06_KRW /* 06월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN SALE_AMT_KRW END) AS SALE_AMT_07_KRW /* 07월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN SALE_AMT_KRW END) AS SALE_AMT_08_KRW /* 08월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN SALE_AMT_KRW END) AS SALE_AMT_09_KRW /* 09월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN SALE_AMT_KRW END) AS SALE_AMT_10_KRW /* 10월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN SALE_AMT_KRW END) AS SALE_AMT_11_KRW /* 11월 일매출           YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN SALE_AMT_KRW END) AS SALE_AMT_12_KRW /* 12월 일매출           YoY - 원화   */

              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 01 THEN EXRE_AMT_KRW END) AS EXRE_AMT_01_KRW /* 01월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 02 THEN EXRE_AMT_KRW END) AS EXRE_AMT_02_KRW /* 02월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 03 THEN EXRE_AMT_KRW END) AS EXRE_AMT_03_KRW /* 03월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 04 THEN EXRE_AMT_KRW END) AS EXRE_AMT_04_KRW /* 04월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 05 THEN EXRE_AMT_KRW END) AS EXRE_AMT_05_KRW /* 05월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 06 THEN EXRE_AMT_KRW END) AS EXRE_AMT_06_KRW /* 06월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 07 THEN EXRE_AMT_KRW END) AS EXRE_AMT_07_KRW /* 07월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 08 THEN EXRE_AMT_KRW END) AS EXRE_AMT_08_KRW /* 08월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 09 THEN EXRE_AMT_KRW END) AS EXRE_AMT_09_KRW /* 09월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 10 THEN EXRE_AMT_KRW END) AS EXRE_AMT_10_KRW /* 10월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 11 THEN EXRE_AMT_KRW END) AS EXRE_AMT_11_KRW /* 11월 일매출(환불제외) YoY - 원화   */
              ,SUM(CASE WHEN EXTRACT(MONTH FROM CAST(STATISTICS_DATE AS DATE)) = 12 THEN EXRE_AMT_KRW END) AS EXRE_AMT_12_KRW /* 12월 일매출(환불제외) YoY - 원화   */
          FROM WT_EXCH_YOY A
    ), WT_BASE AS
    (
         SELECT A.SORT_KEY
               ,A.ROW_TITL
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_01_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_01_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_01_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_01_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_01_RMB  /* 01월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_02_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_02_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_02_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_02_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_02_RMB  /* 02월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_03_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_03_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_03_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_03_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_03_RMB  /* 03월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_04_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_04_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_04_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_04_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_04_RMB  /* 04월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_05_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_05_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_05_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_05_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_05_RMB  /* 05월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_06_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_06_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_06_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_06_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_06_RMB  /* 06월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_07_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_07_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_07_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_07_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_07_RMB  /* 07월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_08_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_08_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_08_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_08_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_08_RMB  /* 08월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_09_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_09_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_09_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_09_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_09_RMB  /* 09월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_10_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_10_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_10_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_10_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_10_RMB  /* 10월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_11_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_11_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_11_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_11_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_11_RMB  /* 11월 일매출 - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_12_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_12_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_12_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_12_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_12_RMB  /* 12월 일매출 - 위안화 */

               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_01_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_01_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_01_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_01_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_01_RMB  /* 01월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_02_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_02_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_02_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_02_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_01_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_02_RMB  /* 02월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_03_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_03_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_03_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_03_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_02_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_03_RMB  /* 03월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_04_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_04_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_04_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_04_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_03_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_04_RMB  /* 04월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_05_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_05_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_05_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_05_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_04_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_05_RMB  /* 05월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_06_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_06_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_06_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_06_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_05_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_06_RMB  /* 06월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_07_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_07_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_07_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_07_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_06_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_07_RMB  /* 07월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_08_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_08_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_08_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_08_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_07_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_08_RMB  /* 08월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_09_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_09_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_09_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_09_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_08_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_09_RMB  /* 09월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_10_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_10_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_10_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_10_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_09_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_10_RMB  /* 10월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_11_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_11_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_11_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_11_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_10_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_11_RMB  /* 11월 일매출(환불제외) - 위안화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_12_RMB
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_12_RMB, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_12_RMB, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_12_RMB, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_11_RMB, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_12_RMB  /* 12월 일매출(환불제외) - 위안화 */

               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_01_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_01_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_01_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_01_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_01_KRW  /* 01월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_02_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_02_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_02_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_02_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_02_KRW  /* 02월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_03_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_03_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_03_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_03_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_03_KRW  /* 03월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_04_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_04_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_04_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_04_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_04_KRW  /* 04월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_05_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_05_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_05_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_05_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_05_KRW  /* 05월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_06_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_06_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_06_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_06_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_06_KRW  /* 06월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_07_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_07_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_07_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_07_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_07_KRW  /* 07월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_08_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_08_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_08_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_08_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_08_KRW  /* 08월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_09_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_09_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_09_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_09_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_09_KRW  /* 09월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_10_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_10_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_10_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_10_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_10_KRW  /* 10월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_11_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_11_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_11_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_11_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_11_KRW  /* 11월 일매출 - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN SALE_AMT_12_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(SALE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_12_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_12_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(SALE_AMT_12_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(SALE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(SALE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS SALE_AMT_12_KRW  /* 12월 일매출 - 원화 */

               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_01_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_01_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_01_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_01_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_01_KRW  /* 01월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_02_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_02_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_02_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_02_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_01_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_02_KRW  /* 02월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_03_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_03_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_03_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_03_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_02_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_03_KRW  /* 03월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_04_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_04_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_04_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_04_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_03_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_04_KRW  /* 04월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_05_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_05_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_05_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_05_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_04_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_05_KRW  /* 05월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_06_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_06_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_06_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_06_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_05_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_06_KRW  /* 06월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_07_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_07_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_07_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_07_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_06_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_07_KRW  /* 07월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_08_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_08_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_08_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_08_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_07_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_08_KRW  /* 08월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_09_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_09_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_09_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_09_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_08_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_09_KRW  /* 09월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_10_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_10_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_10_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_10_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_09_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_10_KRW  /* 10월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_11_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_11_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_11_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_11_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_10_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_11_KRW  /* 11월 일매출(환불제외) - 원화 */
               ,CASE
                  WHEN A.SORT_KEY IN (1, 2)
                  THEN EXRE_AMT_12_KRW
                  WHEN A.SORT_KEY = 3
                  THEN (LAG(EXRE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_12_KRW, 1) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_12_KRW, 1) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
                  WHEN A.SORT_KEY = 4
                  THEN (LAG(EXRE_AMT_12_KRW, 3) OVER(ORDER BY A.SORT_KEY) - COALESCE(LAG(EXRE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY))) / COALESCE(NULLIF(LAG(EXRE_AMT_11_KRW, 3) OVER(ORDER BY A.SORT_KEY), 0), 1) * 100
               END AS EXRE_AMT_12_KRW  /* 12월 일매출(환불제외) - 원화 */
          FROM WT_COPY A LEFT OUTER JOIN 
               WT_SUM  B 
            ON (A.SORT_KEY = B.SORT_KEY)
    ), WT_CALC AS
    (
        SELECT SORT_KEY
              ,ROW_TITL
              ,CASE WHEN B.MNTH_YOY = 01 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_01_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_01_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_01_RMB END  AS MAIN_SALE_AMT_01_RMB   /* 01월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 02 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_02_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_02_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_02_RMB END  AS MAIN_SALE_AMT_02_RMB   /* 02월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 03 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_03_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_03_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_03_RMB END  AS MAIN_SALE_AMT_03_RMB   /* 03월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 04 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_04_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_04_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_04_RMB END  AS MAIN_SALE_AMT_04_RMB   /* 04월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 05 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_05_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_05_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_05_RMB END  AS MAIN_SALE_AMT_05_RMB   /* 05월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 06 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_06_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_06_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_06_RMB END  AS MAIN_SALE_AMT_06_RMB   /* 06월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 07 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_07_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_07_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_07_RMB END  AS MAIN_SALE_AMT_07_RMB   /* 07월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 08 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_08_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_08_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_08_RMB END  AS MAIN_SALE_AMT_08_RMB   /* 08월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 09 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_09_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_09_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_09_RMB END  AS MAIN_SALE_AMT_09_RMB   /* 09월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 10 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_10_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_10_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_10_RMB END  AS MAIN_SALE_AMT_10_RMB   /* 10월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 11 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_11_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_11_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_11_RMB END  AS MAIN_SALE_AMT_11_RMB   /* 11월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 12 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_12_RMB WHEN SORT_KEY = 2 THEN B.SALE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_RMB)) / COALESCE(NULLIF(B.SALE_AMT_RMB, 0), 1) * 100 END ELSE SALE_AMT_12_RMB END  AS MAIN_SALE_AMT_12_RMB   /* 12월 일매출 - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 01 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_01_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_01_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_01_RMB END  AS MAIN_EXRE_AMT_01_RMB   /* 01월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 02 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_02_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_02_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_02_RMB END  AS MAIN_EXRE_AMT_02_RMB   /* 02월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 03 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_03_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_03_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_03_RMB END  AS MAIN_EXRE_AMT_03_RMB   /* 03월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 04 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_04_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_04_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_04_RMB END  AS MAIN_EXRE_AMT_04_RMB   /* 04월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 05 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_05_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_05_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_05_RMB END  AS MAIN_EXRE_AMT_05_RMB   /* 05월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 06 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_06_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_06_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_06_RMB END  AS MAIN_EXRE_AMT_06_RMB   /* 06월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 07 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_07_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_07_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_07_RMB END  AS MAIN_EXRE_AMT_07_RMB   /* 07월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 08 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_08_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_08_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_08_RMB END  AS MAIN_EXRE_AMT_08_RMB   /* 08월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 09 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_09_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_09_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_09_RMB END  AS MAIN_EXRE_AMT_09_RMB   /* 09월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 10 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_10_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_10_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_10_RMB END  AS MAIN_EXRE_AMT_10_RMB   /* 10월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 11 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_11_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_11_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_11_RMB END  AS MAIN_EXRE_AMT_11_RMB   /* 11월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 12 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_12_RMB WHEN SORT_KEY = 2 THEN B.EXRE_AMT_RMB WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_12_RMB, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_RMB)) / COALESCE(NULLIF(B.EXRE_AMT_RMB, 0), 1) * 100 END ELSE EXRE_AMT_12_RMB END  AS MAIN_EXRE_AMT_12_RMB   /* 12월 일매출(환불제외) - 위안화 */ 
              ,CASE WHEN B.MNTH_YOY = 01 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_01_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_01_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_01_KRW END  AS MAIN_SALE_AMT_01_KRW   /* 01월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 02 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_02_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_02_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_02_KRW END  AS MAIN_SALE_AMT_02_KRW   /* 02월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 03 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_03_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_03_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_03_KRW END  AS MAIN_SALE_AMT_03_KRW   /* 03월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 04 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_04_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_04_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_04_KRW END  AS MAIN_SALE_AMT_04_KRW   /* 04월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 05 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_05_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_05_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_05_KRW END  AS MAIN_SALE_AMT_05_KRW   /* 05월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 06 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_06_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_06_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_06_KRW END  AS MAIN_SALE_AMT_06_KRW   /* 06월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 07 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_07_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_07_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_07_KRW END  AS MAIN_SALE_AMT_07_KRW   /* 07월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 08 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_08_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_08_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_08_KRW END  AS MAIN_SALE_AMT_08_KRW   /* 08월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 09 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_09_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_09_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_09_KRW END  AS MAIN_SALE_AMT_09_KRW   /* 09월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 10 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_10_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_10_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_10_KRW END  AS MAIN_SALE_AMT_10_KRW   /* 10월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 11 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_11_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_11_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_11_KRW END  AS MAIN_SALE_AMT_11_KRW   /* 11월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 12 THEN CASE WHEN SORT_KEY IN (1, 4) THEN SALE_AMT_12_KRW WHEN SORT_KEY = 2 THEN B.SALE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(SALE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.SALE_AMT_KRW)) / COALESCE(NULLIF(B.SALE_AMT_KRW, 0), 1) * 100 END ELSE SALE_AMT_12_KRW END  AS MAIN_SALE_AMT_12_KRW   /* 12월 일매출 - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 01 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_01_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_01_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_01_KRW END  AS MAIN_EXRE_AMT_01_KRW   /* 01월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 02 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_02_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_02_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_02_KRW END  AS MAIN_EXRE_AMT_02_KRW   /* 02월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 03 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_03_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_03_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_03_KRW END  AS MAIN_EXRE_AMT_03_KRW   /* 03월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 04 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_04_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_04_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_04_KRW END  AS MAIN_EXRE_AMT_04_KRW   /* 04월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 05 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_05_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_05_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_05_KRW END  AS MAIN_EXRE_AMT_05_KRW   /* 05월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 06 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_06_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_06_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_06_KRW END  AS MAIN_EXRE_AMT_06_KRW   /* 06월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 07 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_07_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_07_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_07_KRW END  AS MAIN_EXRE_AMT_07_KRW   /* 07월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 08 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_08_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_08_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_08_KRW END  AS MAIN_EXRE_AMT_08_KRW   /* 08월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 09 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_09_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_09_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_09_KRW END  AS MAIN_EXRE_AMT_09_KRW   /* 09월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 10 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_10_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_10_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_10_KRW END  AS MAIN_EXRE_AMT_10_KRW   /* 10월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 11 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_11_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_11_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_11_KRW END  AS MAIN_EXRE_AMT_11_KRW   /* 11월 일매출(환불제외) - 원화 */ 
              ,CASE WHEN B.MNTH_YOY = 12 THEN CASE WHEN SORT_KEY IN (1, 4) THEN EXRE_AMT_12_KRW WHEN SORT_KEY = 2 THEN B.EXRE_AMT_KRW WHEN SORT_KEY = 3 THEN (LAG(EXRE_AMT_12_KRW, 2) OVER(ORDER BY A.SORT_KEY) - COALESCE(B.EXRE_AMT_KRW)) / COALESCE(NULLIF(B.EXRE_AMT_KRW, 0), 1) * 100 END ELSE EXRE_AMT_12_KRW END  AS MAIN_EXRE_AMT_12_KRW   /* 12월 일매출(환불제외) - 원화 */ 
    
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_SALE_AMT_12_KRW
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN E'\n'||'(' ELSE '' END  AS L_PARN_EXRE_AMT_12_KRW
    
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_01_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_01_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_02_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_02_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_03_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_03_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_04_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_04_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_05_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_05_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_06_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_06_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_07_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_07_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_08_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_08_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_09_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_09_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_10_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_10_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_11_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_11_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_12_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_12_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_01_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_01_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_02_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_02_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_03_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_03_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_04_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_04_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_05_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_05_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_06_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_06_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_07_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_07_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_08_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_08_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_09_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_09_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_10_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_10_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_11_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_11_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_12_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_12_RMB, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_01_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_01_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_02_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_02_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_03_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_03_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_04_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_04_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_05_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_05_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_06_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_06_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_07_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_07_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_08_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_08_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_09_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_09_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_10_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_10_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_11_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_11_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(SALE_AMT_12_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(SALE_AMT_12_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_SALE_AMT_12_KRW
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_01_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_01_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_02_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_02_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_03_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_03_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_04_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_04_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_05_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_05_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_06_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_06_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_07_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_07_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_08_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_08_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_09_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_09_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_10_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_10_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_11_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_11_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(EXRE_AMT_12_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(EXRE_AMT_12_KRW, 'FM999,999,999,999,990.00%') END ELSE '' END  AS SUB_EXRE_AMT_12_KRW
    
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_01_RMB
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_02_RMB
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_03_RMB
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_04_RMB
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_05_RMB
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_06_RMB
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_07_RMB
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_08_RMB
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_09_RMB
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_10_RMB
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_11_RMB
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_12_RMB
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_SALE_AMT_12_KRW
              ,CASE WHEN B.MNTH_YOY = 01 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_01_KRW
              ,CASE WHEN B.MNTH_YOY = 02 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_02_KRW
              ,CASE WHEN B.MNTH_YOY = 03 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_03_KRW
              ,CASE WHEN B.MNTH_YOY = 04 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_04_KRW
              ,CASE WHEN B.MNTH_YOY = 05 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_05_KRW
              ,CASE WHEN B.MNTH_YOY = 06 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_06_KRW
              ,CASE WHEN B.MNTH_YOY = 07 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_07_KRW
              ,CASE WHEN B.MNTH_YOY = 08 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_08_KRW
              ,CASE WHEN B.MNTH_YOY = 09 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_09_KRW
              ,CASE WHEN B.MNTH_YOY = 10 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_10_KRW
              ,CASE WHEN B.MNTH_YOY = 11 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_11_KRW
              ,CASE WHEN B.MNTH_YOY = 12 AND SORT_KEY IN (2, 3) THEN ')' ELSE '' END  AS R_PARN_EXRE_AMT_12_KRW
          FROM WT_BASE         A
              ,WT_SUM_MNTH_YOY B
    )
    SELECT ROW_TITL
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_01_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_01_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_01_RMB||SUB_SALE_AMT_01_RMB||R_PARN_SALE_AMT_01_RMB  AS SALE_AMT_01_RMB   /* 01월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_02_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_02_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_02_RMB||SUB_SALE_AMT_02_RMB||R_PARN_SALE_AMT_02_RMB  AS SALE_AMT_02_RMB   /* 02월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_03_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_03_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_03_RMB||SUB_SALE_AMT_03_RMB||R_PARN_SALE_AMT_03_RMB  AS SALE_AMT_03_RMB   /* 03월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_04_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_04_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_04_RMB||SUB_SALE_AMT_04_RMB||R_PARN_SALE_AMT_04_RMB  AS SALE_AMT_04_RMB   /* 04월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_05_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_05_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_05_RMB||SUB_SALE_AMT_05_RMB||R_PARN_SALE_AMT_05_RMB  AS SALE_AMT_05_RMB   /* 05월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_06_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_06_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_06_RMB||SUB_SALE_AMT_06_RMB||R_PARN_SALE_AMT_06_RMB  AS SALE_AMT_06_RMB   /* 06월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_07_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_07_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_07_RMB||SUB_SALE_AMT_07_RMB||R_PARN_SALE_AMT_07_RMB  AS SALE_AMT_07_RMB   /* 07월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_08_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_08_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_08_RMB||SUB_SALE_AMT_08_RMB||R_PARN_SALE_AMT_08_RMB  AS SALE_AMT_08_RMB   /* 08월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_09_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_09_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_09_RMB||SUB_SALE_AMT_09_RMB||R_PARN_SALE_AMT_09_RMB  AS SALE_AMT_09_RMB   /* 09월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_10_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_10_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_10_RMB||SUB_SALE_AMT_10_RMB||R_PARN_SALE_AMT_10_RMB  AS SALE_AMT_10_RMB   /* 10월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_11_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_11_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_11_RMB||SUB_SALE_AMT_11_RMB||R_PARN_SALE_AMT_11_RMB  AS SALE_AMT_11_RMB   /* 11월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_12_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_12_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_12_RMB||SUB_SALE_AMT_12_RMB||R_PARN_SALE_AMT_12_RMB  AS SALE_AMT_12_RMB   /* 12월 일매출 - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_01_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_01_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_01_RMB||SUB_EXRE_AMT_01_RMB||R_PARN_EXRE_AMT_01_RMB  AS EXRE_AMT_01_RMB   /* 01월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_02_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_02_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_02_RMB||SUB_EXRE_AMT_02_RMB||R_PARN_EXRE_AMT_02_RMB  AS EXRE_AMT_02_RMB   /* 02월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_03_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_03_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_03_RMB||SUB_EXRE_AMT_03_RMB||R_PARN_EXRE_AMT_03_RMB  AS EXRE_AMT_03_RMB   /* 03월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_04_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_04_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_04_RMB||SUB_EXRE_AMT_04_RMB||R_PARN_EXRE_AMT_04_RMB  AS EXRE_AMT_04_RMB   /* 04월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_05_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_05_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_05_RMB||SUB_EXRE_AMT_05_RMB||R_PARN_EXRE_AMT_05_RMB  AS EXRE_AMT_05_RMB   /* 05월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_06_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_06_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_06_RMB||SUB_EXRE_AMT_06_RMB||R_PARN_EXRE_AMT_06_RMB  AS EXRE_AMT_06_RMB   /* 06월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_07_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_07_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_07_RMB||SUB_EXRE_AMT_07_RMB||R_PARN_EXRE_AMT_07_RMB  AS EXRE_AMT_07_RMB   /* 07월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_08_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_08_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_08_RMB||SUB_EXRE_AMT_08_RMB||R_PARN_EXRE_AMT_08_RMB  AS EXRE_AMT_08_RMB   /* 08월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_09_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_09_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_09_RMB||SUB_EXRE_AMT_09_RMB||R_PARN_EXRE_AMT_09_RMB  AS EXRE_AMT_09_RMB   /* 09월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_10_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_10_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_10_RMB||SUB_EXRE_AMT_10_RMB||R_PARN_EXRE_AMT_10_RMB  AS EXRE_AMT_10_RMB   /* 10월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_11_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_11_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_11_RMB||SUB_EXRE_AMT_11_RMB||R_PARN_EXRE_AMT_11_RMB  AS EXRE_AMT_11_RMB   /* 11월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_12_RMB, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_12_RMB, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_12_RMB||SUB_EXRE_AMT_12_RMB||R_PARN_EXRE_AMT_12_RMB  AS EXRE_AMT_12_RMB   /* 12월 일매출(환불제외) - 위안화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_01_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_01_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_01_KRW||SUB_SALE_AMT_01_KRW||R_PARN_SALE_AMT_01_KRW  AS SALE_AMT_01_KRW   /* 01월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_02_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_02_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_02_KRW||SUB_SALE_AMT_02_KRW||R_PARN_SALE_AMT_02_KRW  AS SALE_AMT_02_KRW   /* 02월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_03_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_03_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_03_KRW||SUB_SALE_AMT_03_KRW||R_PARN_SALE_AMT_03_KRW  AS SALE_AMT_03_KRW   /* 03월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_04_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_04_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_04_KRW||SUB_SALE_AMT_04_KRW||R_PARN_SALE_AMT_04_KRW  AS SALE_AMT_04_KRW   /* 04월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_05_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_05_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_05_KRW||SUB_SALE_AMT_05_KRW||R_PARN_SALE_AMT_05_KRW  AS SALE_AMT_05_KRW   /* 05월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_06_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_06_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_06_KRW||SUB_SALE_AMT_06_KRW||R_PARN_SALE_AMT_06_KRW  AS SALE_AMT_06_KRW   /* 06월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_07_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_07_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_07_KRW||SUB_SALE_AMT_07_KRW||R_PARN_SALE_AMT_07_KRW  AS SALE_AMT_07_KRW   /* 07월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_08_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_08_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_08_KRW||SUB_SALE_AMT_08_KRW||R_PARN_SALE_AMT_08_KRW  AS SALE_AMT_08_KRW   /* 08월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_09_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_09_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_09_KRW||SUB_SALE_AMT_09_KRW||R_PARN_SALE_AMT_09_KRW  AS SALE_AMT_09_KRW   /* 09월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_10_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_10_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_10_KRW||SUB_SALE_AMT_10_KRW||R_PARN_SALE_AMT_10_KRW  AS SALE_AMT_10_KRW   /* 10월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_11_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_11_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_11_KRW||SUB_SALE_AMT_11_KRW||R_PARN_SALE_AMT_11_KRW  AS SALE_AMT_11_KRW   /* 11월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_SALE_AMT_12_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_SALE_AMT_12_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_SALE_AMT_12_KRW||SUB_SALE_AMT_12_KRW||R_PARN_SALE_AMT_12_KRW  AS SALE_AMT_12_KRW   /* 12월 일매출 - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_01_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_01_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_01_KRW||SUB_EXRE_AMT_01_KRW||R_PARN_EXRE_AMT_01_KRW  AS EXRE_AMT_01_KRW   /* 01월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_02_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_02_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_02_KRW||SUB_EXRE_AMT_02_KRW||R_PARN_EXRE_AMT_02_KRW  AS EXRE_AMT_02_KRW   /* 02월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_03_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_03_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_03_KRW||SUB_EXRE_AMT_03_KRW||R_PARN_EXRE_AMT_03_KRW  AS EXRE_AMT_03_KRW   /* 03월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_04_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_04_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_04_KRW||SUB_EXRE_AMT_04_KRW||R_PARN_EXRE_AMT_04_KRW  AS EXRE_AMT_04_KRW   /* 04월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_05_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_05_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_05_KRW||SUB_EXRE_AMT_05_KRW||R_PARN_EXRE_AMT_05_KRW  AS EXRE_AMT_05_KRW   /* 05월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_06_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_06_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_06_KRW||SUB_EXRE_AMT_06_KRW||R_PARN_EXRE_AMT_06_KRW  AS EXRE_AMT_06_KRW   /* 06월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_07_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_07_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_07_KRW||SUB_EXRE_AMT_07_KRW||R_PARN_EXRE_AMT_07_KRW  AS EXRE_AMT_07_KRW   /* 07월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_08_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_08_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_08_KRW||SUB_EXRE_AMT_08_KRW||R_PARN_EXRE_AMT_08_KRW  AS EXRE_AMT_08_KRW   /* 08월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_09_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_09_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_09_KRW||SUB_EXRE_AMT_09_KRW||R_PARN_EXRE_AMT_09_KRW  AS EXRE_AMT_09_KRW   /* 09월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_10_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_10_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_10_KRW||SUB_EXRE_AMT_10_KRW||R_PARN_EXRE_AMT_10_KRW  AS EXRE_AMT_10_KRW   /* 10월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_11_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_11_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_11_KRW||SUB_EXRE_AMT_11_KRW||R_PARN_EXRE_AMT_11_KRW  AS EXRE_AMT_11_KRW   /* 11월 일매출(환불제외) - 원화 */
          ,CASE WHEN SORT_KEY IN (1, 2) THEN TO_CHAR(MAIN_EXRE_AMT_12_KRW, 'FM999,999,999,999,990') ELSE TO_CHAR(MAIN_EXRE_AMT_12_KRW, 'FM999,999,999,999,990.00%') END||L_PARN_EXRE_AMT_12_KRW||SUB_EXRE_AMT_12_KRW||R_PARN_EXRE_AMT_12_KRW  AS EXRE_AMT_12_KRW   /* 12월 일매출(환불제외) - 원화 */
      FROM WT_CALC A
  ORDER BY SORT_KEY
